{"root":{"data":{"id":"c1glxjubr540","created":1584803436372,"text":"Django"},"children":[{"data":{"id":"c1gly8gq7ko0","created":1584803489969,"text":"创建项目","layout_mind_offset":{"x":42,"y":-278},"layout":null},"children":[{"data":{"id":"c1glyf7khyg0","created":1584803504653,"text":"1，在合适位置创建目录","layout":null},"children":[]},{"data":{"id":"c1gm5ldgwtc0","created":1584804066619,"text":"2,进入目录","layout":null},"children":[]},{"data":{"id":"c1gm5ojkwm00","created":1584804073519,"text":"3,创建项目的命令：django-admin startproject myApp","layout":null},"children":[]},{"data":{"id":"c1gm5z2pakg0","created":1584804096443,"text":"4,目录层级说明","layout":null},"children":[{"data":{"id":"c1gm6620sko0","created":1584804111639,"text":"manager.py","layout":null},"children":[{"data":{"id":"c1gm6chk3mo0","created":1584804125639,"text":"一个命令行工具，可以是我们用多种方式对django项目进行交互","layout":null},"children":[]}]},{"data":{"id":"c1gm703i7ew0","created":1584804177033,"text":"project目录","layout":null},"children":[{"data":{"id":"c1gm740gmqg0","created":1584804185556,"text":"__init__py","layout":null},"children":[{"data":{"id":"c1gm78thtug0","created":1584804196018,"text":"告诉python，这个一个python包","layout":null},"children":[]}]},{"data":{"id":"c1gm7jd5gy80","created":1584804218975,"text":"settings.py","layout":null},"children":[{"data":{"id":"c1gm7mtvkps0","created":1584804226516,"text":"整体项目配置文件，对应的还有app的配置文件","layout":null},"children":[]}]},{"data":{"id":"c1gm7yjsr5s0","created":1584804252028,"text":"urls.py","layout":null},"children":[{"data":{"id":"c1gm80w52rk0","created":1584804257128,"text":"项目的URL声明，相当于URL控制器","layout":null},"children":[]}]},{"data":{"id":"c1gm8byy7lc0","created":1584804281243,"text":"wsgi.py","layout":null},"children":[{"data":{"id":"c1gm8i71l6w0","created":1584804294793,"text":"项目与WSGI兼容的web服务器入口","layout":null},"children":[]}]}]}]}]},{"data":{"id":"c1gm8s368e00","created":1584804316327,"text":"基本操作","layout_mind_offset":{"x":464,"y":475},"layout":null,"expandState":"expand"},"children":[{"data":{"id":"c1gm92hp0k00","created":1584804338972,"text":"设计表结构","layout":null},"children":[{"data":{"id":"c1gm980e2og0","created":1584804350987,"text":"班级表结构","layout":null},"children":[{"data":{"id":"c1gm9cicqaw0","created":1584804360780,"text":"表名，grades","layout":null},"children":[]},{"data":{"id":"c1gma785bso0","created":1584804427643,"text":"字段","layout":null},"children":[{"data":{"id":"c1gmafvwvqo0","created":1584804446494,"text":"班级名称，gname","layout":null},"children":[]},{"data":{"id":"c1gmapyxj140","created":1584804468445,"text":"成立时间，gdate","layout":null},"children":[]},{"data":{"id":"c1gmarjs8uo0","created":1584804471882,"text":"女生总数，ggirlnum","layout":null},"children":[]},{"data":{"id":"c1gmauw15e80","created":1584804479153,"text":"男生总数，gboynum","layout":null},"children":[]},{"data":{"id":"c1gmb2qvvw80","created":1584804496256,"text":"是否删除，isDelete","layout":null},"children":[]}]}]},{"data":{"id":"c1gmctd06vc0","created":1584804632554,"text":"学生表结构","layout":null},"children":[{"data":{"id":"c1gmd4ifuiw0","created":1584804656828,"text":"表明，students","layout":null},"children":[]},{"data":{"id":"c1gmdb0afuo0","created":1584804670968,"text":"字段","layout":null},"children":[{"data":{"id":"c1gmddd8b4w0","created":1584804676104,"text":"学生姓名，sname","layout":null},"children":[]},{"data":{"id":"c1gmdi3atb40","created":1584804686387,"text":"学生性别，sgender","layout":null},"children":[]},{"data":{"id":"c1gmdm84hb40","created":1584804695386,"text":"学生年龄，sage","layout":null},"children":[]},{"data":{"id":"c1gmdwexeqw0","created":1584804717565,"text":"学生简介，scontend","layout":null},"children":[]},{"data":{"id":"c1gme3nxguw0","created":1584804733347,"text":"所属班级，sgrade","layout":null},"children":[]},{"data":{"id":"c1gme8gmgvk0","created":1584804743789,"text":"是否删除，isDelete","layout":null},"children":[]}]}]}]},{"data":{"id":"c1gmfcdxfnc0","created":1584804830697,"text":"配置数据库","layout":null,"expandState":"expand"},"children":[{"data":{"id":"c1gmg4zzz540","created":1584804892983,"text":"1,Django默认使用sqllite","layout":null},"children":[]},{"data":{"id":"c1gmh7n2u340","created":1584804977095,"text":"2,配置数据库方法，在settings.py文件中，通过DATEBASES选项进行数据库配置","layout":null},"children":[]},{"data":{"id":"c1gmiimqux40","created":1584805079384,"text":"3,配置MySQL","layout":null,"expandState":"expand"},"children":[{"data":{"id":"c1gmin616ag0","created":1584805089257,"text":"1,python 3.x安装的是PyMySQL","layout":null},"children":[]},{"data":{"id":"c1gmj1hxwd40","created":1584805120452,"text":"2,在__init__.py文件中写入，import pymysql  pymysql.install_as_MySQLdb()","layout":null},"children":[]},{"data":{"id":"c1gmkkzj5ug0","created":1584805241239,"text":"3,在settings.py中配置，DATABASES = {                            'default': {\n\t                            'ENGINE': 'django.db.backends.mysql',\n\t                            'NAME': \"sunck\",  # 直接写数据库名也可以\n\t                            'USER': \"user\",  # 直接写数据库名也可以\n\t                            'PASSWORD': \"password\",  # 直接写数据库名也可以\n\t                            'HOST': \"localhost\",  # 直接写数据库名也可以\n\t                            'PORT': 3306,  # 直接写数据库名也可以\n\t                        }","layout":null},"children":[]}]},{"data":{"id":"c1gmoz9ossw0","created":1584805585785,"text":"4,定义模型","layout":null},"children":[{"data":{"id":"c1gmp2s26m00","created":1584805593426,"text":"1,有一个数据表，就对应一个模型","layout":null},"children":[]},{"data":{"id":"c1gmpbm0hog0","created":1584805612651,"text":"2,在models.py中定义模型","layout":null},"children":[{"data":{"id":"c1gmpia9ldc0","created":1584805627178,"text":"1,在myApp文件的models.py中引入 from django.db imort models","layout":null},"children":[]},{"data":{"id":"c1gmqe0gbgg0","created":1584805696242,"text":"2,引入的作用，模型类要继承models.Models类","layout":null},"children":[]},{"data":{"id":"c1gn8a7zpsw0","created":1584807098546,"text":"3,在models.py文件中定义模型"},"children":[]},{"data":{"id":"c1gn8hikugo0","created":1584807114423,"text":"4,说明，不需要定义主键，默认自动会添加，且自动自增1"},"children":[]}]}]},{"data":{"id":"c1gn90vblkg0","created":1584807156553,"text":"5,在数据库中生成数据表"},"children":[{"data":{"id":"c1gn9chjrmo0","created":1584807181841,"text":"1,生成迁移文件，在firstSite文件的project中执行，python3 manage.py makemigrations"},"children":[]},{"data":{"id":"c1gna30i2ns0","created":1584807239584,"text":"2,在新创建的migrations目录中生成了迁移文件"},"children":[]},{"data":{"id":"c1gnap18gso0","created":1584807287517,"text":"3,执行迁移，python3 manage.py migrate"},"children":[]}]},{"data":{"id":"c1gnb0qvhkw0","created":1584807313012,"text":"6,测试数据操作","layout_right_offset":{"x":2.4999999627469833,"y":-17.499999739229565}},"children":[{"data":{"id":"c1gnb4vt2z40","created":1584807322018,"text":"1,执行python3 manage.py shell"},"children":[]},{"data":{"id":"c1gnbahgf1s0","created":1584807334210,"text":"2,在此shell环境中引入包"},"children":[{"data":{"id":"c1gnbicx5uo0","created":1584807351351,"text":"from myApp.models import Grades,Students\nfrom django.utils import timezone\nfrom datetime import *"},"children":[]}]},{"data":{"id":"c1gnddxwy2o0","created":1584807498464,"text":"3,查询所有数据，格式：类名.objects.all(),实例Grades.objects.all()"},"children":[]},{"data":{"id":"c1gne9wakhs0","created":1584807568023,"text":"4,添加数据，本质就是创建一个模型类的对象实例"},"children":[{"data":{"id":"c1gnesc17iw0","created":1584807608157,"text":"1,grade1 = Grades()\n2,grade1.gname = \"python4\"\n3,grade1.gdate = datetime(year=2017,month=7,day=17)\n4,grade1.ggirlnum = 3\n5,grade1.gboynum = 70\n6,grade1.save()\n7,重新__str__(self)函数：\n\t   def __str__(self):\n\t                   return \"%s-%d-%d\" % (self.gname,self.ggirlnum,self.gboynum)\n8,再一次查询所有数据，Grades.objects.all()\n9,再插入一条\ngrade2 = Grades()\ngrade2.gname = \"python5\"\ngrade2.gdate = datetime(year=2017,month=7,day=31)\ngrade2.ggirlnum = 1\ngrade2.gboynum = 50\ngrade2.save()","layout_right_offset":{"x":48,"y":0}},"children":[]}]},{"data":{"id":"c1gngp2eb2w0","created":1584807757772,"text":"5,查询指定对象"},"children":[{"data":{"id":"c1gngzyxopc0","created":1584807781508,"text":"1,格式：类名.objects.get(pk=2),实例，g2 = Grades.objects.get(pk=2)"},"children":[]}]},{"data":{"id":"c1gnhqzjafk0","created":1584807840317,"text":"6,修改一条数据中的某个值，模型对象.属性 = 新值，实例:grade2.gboynum = 60,然后保存grade2.save()"},"children":[]},{"data":{"id":"c1gnhvbprhc0","created":1584807849761,"text":"7,删除一条数据，模型对象.delete(),实例：grade2.delete()，直接从数据库中物理删除。"},"children":[]},{"data":{"id":"c1gni1wejbs0","created":1584807864072,"text":"8,关联对象,把学生表中学生项和班级表中班级项关联起来"},"children":[{"data":{"id":"c1gni6mr15s0","created":1584807874373,"text":"1,获取班级\ngrade1 = Grades.objects.get(pk=1)"},"children":[]},{"data":{"id":"c1gnik8w9dc0","created":1584807904010,"text":"2,添加学生数据，\nstu = Students()\nstu.sname = \"zhangsan\"\nstu.sgender = False\nstu.sage = 20\nstu.sconted = \"i am zhangsan\"\nstu.sgrade = grad"},"children":[]},{"data":{"id":"c1gnjdz39yw0","created":1584807968720,"text":"3,跨表查询，获取python04班的所有学生\n格式：对象名.关联的类名小写_set.all()，其中set方法是自定义函数\ngrades1.students_set.all()"},"children":[]},{"data":{"id":"c1gnk0vgu940","created":1584808018567,"text":"4,添加学生数据并关联班级python04，这种方法不用save()方法\nstu2 = grade1.students_set.create(sname=\"wangwu\",sage = 45,sconted=\"wo shi wangwu\")"},"children":[]}]},{"data":{"id":"c1gnkerflsw0","created":1584808048798,"text":"9,启动服务器"},"children":[{"data":{"id":"c1gnklg39ag0","created":1584808063351,"text":"1,格式：python3 manager.py runserver ip:port"},"children":[]},{"data":{"id":"c1gnks0oco80","created":1584808077655,"text":"2,说明：ip默认是localhost，可以不写，port默认是8000，可以不写，简化成：python3 manager.py runserver，只用于开发测试，不能用于生产环境"},"children":[]}]},{"data":{"id":"c1gnkzsgjxc0","created":1584808094573,"text":"10,Admin站点管理"},"children":[{"data":{"id":"c1gnl44ikyw0","created":1584808104009,"text":"1,概述"},"children":[{"data":{"id":"c1gnl4zz3i00","created":1584808105911,"text":"1,内容发布:作用是增删改数据库的数据"},"children":[]},{"data":{"id":"c1gnl4zz09s0","created":1584808105911,"text":"2,公告发布："},"children":[]}]},{"data":{"id":"c1gnld1is0o0","created":1584808123420,"text":"2,配置Admin应用，在project中的settings.py中，INSTALLED_APPS标签，默认已经配置，语句：'django.contrib.admin',"},"children":[]},{"data":{"id":"c1gnlido3740","created":1584808135037,"text":"3,创建管理员用户，"},"children":[{"data":{"id":"c1gnlq1ohhc0","created":1584808151727,"text":"1,命令：python3 manage.py createsuperuser\n实例：djangouser/147258Jxy"},"children":[]},{"data":{"id":"c1gnlq1qgz40","created":1584808151730,"text":"2,访问url，ip:8000/admin"},"children":[]},{"data":{"id":"c1gnlq1qp680","created":1584808151730,"text":"3,管理页面显示语言管理，在settings.py，\nLANGUAGE = ‘zh-Hans’\nTIME_ZONE = 'Asia/Shanghai'"},"children":[]},{"data":{"id":"c1gnlq1si0o0","created":1584808151733,"text":"4,在django管理站点中添加数据库管理页面\n修改myApp文件中的admin.py\nfrom .models import Grades, Students \nadmin.site.register(Grades) \nadmin.site.register(Students)"},"children":[]},{"data":{"id":"c1gnnnumj340","created":1584808303675,"text":"5,自定义管理页面","layout_right_offset":{"x":-1,"y":97}},"children":[{"data":{"id":"c1gno7pd1qw0","created":1584808346892,"text":"1,属性说明"},"children":[{"data":{"id":"c1gnomuk3uw0","created":1584808379858,"text":"1,列表页属性\n1,list_display,添加显示字段，就是加个表头字段，可以定制字段多少\nlist_display = [\"pk\", \"gname\", \"gdate\", \"ggirlnum\", \"gboynum\", \"isDelete\"]\n\n2,list_filter,添加一个过滤器，用于过滤字段，参数是过滤条件\nlist_filter = [\"gname\"]\n\n3,search_fields,添加一个搜索框，参数用于指定搜索字段\nsearch_fields = [\"gname\"]\n\n4,list_per_page，每页显示的条目数量，默认是5,大于5才会显示分页\nlist_per_page = 5"},"children":[]},{"data":{"id":"c1gnp04zhlc0","created":1584808408787,"text":"2,添加页、修改页属性\n1,fields，添加和修改时，属性显示的顺序\n实例：fields = [\"ggirlnum\", \"gboynum\", \"gname\", \"gdate\", \"isDelete\"\n2,fieldsets，添加和修改时，把属性分成几个组，\n实例：fieldsets = [\n(\"num\", {\"fields\": [\"ggirlnum\", \"gboynum\"]}),\n(\"base\", {\"fields\": [\"gname\", \"gdate\", \"isDelete\"]})","layout_right_offset":{"x":9,"y":6}},"children":[]}]},{"data":{"id":"c1gnpdqa37c0","created":1584808438373,"text":"2,关联对象"},"children":[{"data":{"id":"c1gnpgrxejk0","created":1584808445003,"text":"1,需求，创建一个班级时，同时能直接添加几个学生信息"},"children":[]},{"data":{"id":"c1gnpzculj40","created":1584808485450,"text":"2，步骤："},"children":[{"data":{"id":"c1gnq7f4nyg0","created":1584808503002,"text":"1,定义一个类\nclass StudentsInfo(admin.TabularInline): # 另一种形式admin.StackedInline\nmodel = Students\nextra = 2"},"children":[]},{"data":{"id":"c1gnql2wwyo0","created":1584808532738,"text":"2,在class GradeAdmin(admin.ModelAdmin):中\n添加语句inlines = [StudentsInfo]"},"children":[]}]}]}]}]}]}]}]},{"data":{"id":"c1gmlwnr4jc0","created":1584805345012,"text":"4,创建应用","layout":null,"priority":null,"layout_right_offset":{"x":70,"y":-10}},"children":[{"data":{"id":"c1gmmape7iw0","created":1584805375586,"text":"1,一个项目可以包含多个应用，每个应用进行一种业务处理","layout":null},"children":[]},{"data":{"id":"c1gmmvv7swg0","created":1584805421651,"text":"2,进入到firstSite文件的project目录","layout":null},"children":[]},{"data":{"id":"c1gmn5go8bk0","created":1584805442540,"text":"3,执行python3 manage.py startapp myApp","layout":null},"children":[]},{"data":{"id":"c1gmnh8irqw0","created":1584805468168,"text":"4,myApp目录说明","layout":null},"children":[{"data":{"id":"c1gmnlm8ki00","created":1584805477704,"text":"1,admin.py,站点配置","layout":null},"children":[]},{"data":{"id":"c1gmnr8py880","created":1584805489948,"text":"2,models.py，模型","layout":null},"children":[]},{"data":{"id":"c1gmnwlht7c0","created":1584805501604,"text":"3,views.py,视图","layout":null},"children":[]}]}]},{"data":{"id":"c1gmo75dmps0","created":1584805524574,"text":"5,激活应用","layout":null,"layout_right_offset":{"x":72,"y":44}},"children":[{"data":{"id":"c1gmobioc6g0","created":1584805534085,"text":"1,在settings.py文件中，将新建的应用myApp加入到INSTALLED_APPS中，最后一行添加语句，\"myApp\",","layout":null},"children":[]}]}]},{"data":{"id":"c1h4i99ztfk0","created":1584855839000,"text":"3,视图的使用","layout_right_offset":{"x":140,"y":64}},"children":[{"data":{"id":"c1h4ioy9e3c0","created":1584855873119,"text":"1,概述，在django中，视图对web请求进行回应"},"children":[]},{"data":{"id":"c1h4jb5ces80","created":1584855921437,"text":"2,本质就是一个python函数，在myApp的views.py中定义\nfrom django.http import HttpResponse\n# 定义了一个视图，也就是一个html页面\ndef index(request):\n\treturn HttpResponse(\"sunck is a good man !\")"},"children":[]},{"data":{"id":"c1h4jvi013c0","created":1584855965738,"text":"3,上一步只是定义了一个视图，还需要在url控制器中配置url，url控制器就是project文件中的urls.py文件\nfrom django.contrib import admin\nfrom django.urls import path\nfrom django.conf.urls import url, include\nurlpatterns = [\n\tpath('admin/', admin.site.urls),\n\turl(r'^', include(\"myApp.urls\")),\n   ]"},"children":[]},{"data":{"id":"c1h4ktiuzkw0","created":1584856039800,"text":"4,还需要在myApp的urls.py中定义\nfrom django.conf.urls import url\nfrom . import views\nurlpatterns = [\n\turl(r'^$', views.index),\n]"},"children":[]},{"data":{"id":"c1h4ldgz3qg0","created":1584856083222,"text":"5,执行顺序说明：先到project的urls.py,再到myApp的urls.py，再到myApp的views.py"},"children":[]}]},{"data":{"id":"c1h4lr9phn40","created":1584856113257,"text":"4,模板的使用"},"children":[{"data":{"id":"c1h4lz7wp940","created":1584856130563,"text":"1,概述，本质是html页面，可以根据视图中传递过来的数据来填充"},"children":[]},{"data":{"id":"c1h4m7ffpm80","created":1584856148432,"text":"2,创建模板目录，创建templates目录，在该目录下创建对应项目的模板目录，project/templates/myApp"},"children":[]},{"data":{"id":"c1h4mdf617k0","created":1584856161477,"text":"3,配置路径"},"children":[{"data":{"id":"c1h4uj8sx7k0","created":1584856801066,"text":"修改settings.py文件，TEMPLATES标签，BASE_DIR是项目project目录，添加模板路径就是\n'DIRS': [os.path.join(BASE_DIR, \"templates\")],"},"children":[]}]},{"data":{"id":"c1h511ebfxs0","created":1584857310766,"text":"4,视图使用步骤"},"children":[{"data":{"id":"c1h5179z9gg0","created":1584857323565,"text":"1,定义了显示班级表和学生表信息的html，grades.html,students.html"},"children":[]},{"data":{"id":"c1h522hciyw0","created":1584857391491,"text":"2,模板语法：\n第一种：{{输出值，可以是变量，也可以是对象属性}}\n第二种：{%执行代码段%}"},"children":[]}]},{"data":{"id":"c1h55sc0qxs0","created":1584857682857,"text":"5,一个需求，输入一个url，http://127.0.0.1:8000/grades"},"children":[{"data":{"id":"c1h5673spiw0","created":1584857715012,"text":"1,写好grades.html，内容就包含了模板语法"},"children":[]},{"data":{"id":"c1h5mb7camg0","created":1584858977760,"text":"2,myApp的views.py中定义视图函数"},"children":[]},{"data":{"id":"c1h5m5ag5ns0","created":1584858964887,"text":"3,myApp下的urls.py做匹配"},"children":[]},{"data":{"id":"c1h5lwejjq80","created":1584858945544,"text":"4,project下的urls.py做匹配"},"children":[]}]},{"data":{"id":"c1h5dgp27m00","created":1584858284438,"text":"6,总结需求实现的步骤：先写模板页面两个html-->myApp的views.py中定义视图函数-->myApp下urls.py做匹配-->project下的urls.py做匹配。\n其中视图函数的内容是先去模型下取数据，然后返回给模板，模板渲染后给浏览器。"},"children":[]},{"data":{"id":"c1h5w6ht5ew0","created":1584859751151,"text":"6,再一个需求，在http://127.0.0.1:8000/grades页面中点击一个班级名称，就把该班级下的学生信息显示出来"},"children":[{"data":{"id":"c1h67gsez5s0","created":1584860635565,"text":"1,模板已经写好了"},"children":[]},{"data":{"id":"c1h67s1qljs0","created":1584860660074,"text":"2,视图views.py中新增定义\ndef gradesStudents(request, num):\n\t# 按传入的班级id号去取所有学生信息\n\tgrade = Grades.objects.get(pk=num)\n\tstudentsList = grade.students_set.all()\n\t# 返回给模板\n\treturn render(request, \"myApp/students.html\", {\"students\": studentsList})"},"children":[]},{"data":{"id":"c1h688reh080","created":1584860696454,"text":"2,myApp中urls.py新增匹配条件\nurl(r\"^grades/(\\d+)/$\", views.gradesStudents),"},"children":[]}]}]}]},"template":"right","theme":"fresh-blue","version":"1.4.43"}